CREATE TABLE ORDERS
(
    ORDER_ID            NUMBER PRIMARY KEY,
    /* OTHER ATTRIBUTES */
    LINE_ITEMS_COUNT    NUMBER DEFAULT 0
);

CREATE TABLE LINE_ITEMS
(
    ORDER_ID            REFERENCES ORDERS,
    SEQ_NO              NUMBER,
    /* OTHER ATTRIBUTES */
    CONSTRAINT LINEITEMS PRIMARY KEY (ORDER_ID, SEQ_NO)
);

CREATE OR REPLACE TRIGGER LINEITEMS_TRIGGER
    AFTER INSERT OR UPDATE OR DELETE ON LINE_ITEMS
    FOR EACH ROW
BEGIN
    IF ( INSERTING OR UPDATEING )
    THEN
        UPDATE ORDERS SET LINE_ITEMS_COUNT = NVL(LINE_ITEMS_COUNT, 0) + 1
        WHERE ORDER_ID = :NEW.ORDER_ID;
    END IF;
    IF ( DELETING OR UPDAEING )
    THEN
        UPDATE ORDERS SET LINE_ITEMS_COUNT = NVL(LINE_ITEMS_COUNT, 0) - 1
        WHERE ORDER_ID = :OLD.ORDER_ID;
    END IF;
END;
